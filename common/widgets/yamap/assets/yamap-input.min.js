!function(e){e.fn.yamapInput=function(a){return this.each(function(){var t=e(this),n=t.find(".yamap-dialog"),o=(n.find(".yamap-area"),t.find(".yamap-search")),i=t.find('input[type="text"]:first'),c=i.val();n.dialog(a.dialog),i.on("click",function(){n.dialog("open")});var r=function(){var e=i.val();return c=e?e.split(","):a.map.center};ymaps.load(function(){var e=new ymaps.SuggestView(o.attr("id"),{offset:[10,10]});e.state.events.add("change",function(){var a=e.state.get("activeIndex");"number"==typeof a&&(activeItem=e.state.get("items")[a],activeItem&&activeItem.value!=o.value&&(o.value=activeItem.value))})}),ymaps.ready(function(){var e=r(),t=new ymaps.Map(a.mapId,{center:e,zoom:a.map.zoom}),n=new ymaps.Placemark(e);t.geoObjects.add(n),t.events.add("click",function(e){var a=e.get("coords");n.geometry.setCoordinates(a),i.val(a.join(","))}),o.on("keyup",function(e){13==e.keyCode&&ymaps.geocode(o.val(),{results:1}).then(function(e){var a=e.geoObjects.get(0),o=a.geometry.getCoordinates();n.geometry.setCoordinates(o),i.val(o.join(",")),t.panTo(o)})})})})}}(jQuery);
